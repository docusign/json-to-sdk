const docusign = require('docusign-esign');

// Send the envelope
const sendDocuSignEnvelope = async (args) => {
{{envelope_definition}}

    try {
        const dsApi = new docusign.ApiClient();
        dsApi.addDefaultHeader('Authorization', 'Bearer ' + args.accessToken);
        dsApi.setBasePath(args.basePath);
        const envelopesApi = new docusign.EnvelopesApi(dsApi);
        return await envelopesApi.createEnvelope(args.accountId,
            {envelopeDefinition: envelopeDefinition});
    } catch (e) {
        console.log (`Error from DocuSign API: ` +
           `${(e && e.response && JSON.stringify(e.response.body))||e}`);
    }
};

const main = async (args) => {
    const result = await sendDocuSignEnvelope(args);
    console.log(JSON.stringify(result, null, 2));
};
